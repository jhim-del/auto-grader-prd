<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í”„ë¡¬í”„íŠ¸ ê²½ì§„ëŒ€íšŒ ìë™ í‰ê°€ í”Œë«í¼ v3.0</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            background: linear-gradient(135deg, #FA0030 0%, #850028 100%);
            color: white;
            padding: 30px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 4px 20px rgba(250, 0, 48, 0.2);
        }
        
        header h1 {
            font-size: 28px;
            margin-bottom: 8px;
        }
        
        header p {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .tabs {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            overflow-x: auto;
            padding-bottom: 8px;
        }
        
        .tab {
            padding: 12px 24px;
            background: white;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            white-space: nowrap;
            font-size: 14px;
            font-weight: 500;
        }
        
        .tab:hover {
            border-color: #FA0030;
            background: #FED3DB;
        }
        
        .tab.active {
            background: #FA0030;
            color: white;
            border-color: #FA0030;
        }
        
        .tab-content {
            display: none;
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .tab-content.active {
            display: block;
        }
        
        .section-title {
            font-size: 20px;
            font-weight: 600;
            color: #FA0030;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #FED3DB;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.3s;
        }
        
        .btn-primary {
            background: #FA0030;
            color: white;
        }
        
        .btn-primary:hover {
            background: #850028;
        }
        
        .btn-secondary {
            background: #93E6F5;
            color: #333;
        }
        
        .btn-secondary:hover {
            background: #D4F3FC;
        }
        
        .btn-danger {
            background: #ff4444;
            color: white;
        }
        
        .btn-danger:hover {
            background: #cc0000;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: #333;
        }
        
        .form-group input,
        .form-group textarea,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }
        
        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }
        
        .list-container {
            display: grid;
            gap: 15px;
            margin-top: 20px;
        }
        
        .list-item {
            background: #f9f9f9;
            padding: 20px;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            transition: all 0.3s;
        }
        
        .list-item:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: #FA0030;
        }
        
        .list-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }
        
        .list-item-title {
            font-size: 16px;
            font-weight: 600;
            color: #FA0030;
        }
        
        .list-item-actions {
            display: flex;
            gap: 8px;
        }
        
        .list-item-body {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }
        
        .badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 500;
        }
        
        .badge-submitted {
            background: #93E6F5;
            color: #333;
        }
        
        .badge-grading {
            background: #FED3DB;
            color: #850028;
        }
        
        .badge-completed {
            background: #4caf50;
            color: white;
        }
        
        .badge-failed {
            background: #ff4444;
            color: white;
        }
        
        .dashboard-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            background: linear-gradient(135deg, #FA0030 0%, #850028 100%);
            color: white;
            padding: 20px;
            border-radius: 8px;
            text-align: center;
        }
        
        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 8px;
        }
        
        .stat-card .value {
            font-size: 32px;
            font-weight: 600;
        }
        
        .score-breakdown {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin: 20px 0;
        }
        
        .score-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            border: 2px solid #e0e0e0;
        }
        
        .score-item.accuracy {
            border-color: #FA0030;
        }
        
        .score-item.clarity {
            border-color: #93E6F5;
        }
        
        .score-item.consistency {
            border-color: #850028;
        }
        
        .score-item h4 {
            font-size: 12px;
            color: #666;
            margin-bottom: 8px;
        }
        
        .score-item .score {
            font-size: 28px;
            font-weight: 600;
        }
        
        .score-item.accuracy .score {
            color: #FA0030;
        }
        
        .score-item.clarity .score {
            color: #1a73e8;
        }
        
        .score-item.consistency .score {
            color: #850028;
        }
        
        .execution-outputs {
            margin-top: 20px;
        }
        
        .output-item {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            border-left: 4px solid #93E6F5;
        }
        
        .output-item h4 {
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }
        
        .output-item pre {
            background: white;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
            line-height: 1.5;
            white-space: pre-wrap;
        }
        
        .feedback-section {
            background: #FED3DB;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        
        .feedback-section h4 {
            font-size: 16px;
            font-weight: 600;
            color: #850028;
            margin-bottom: 12px;
        }
        
        .feedback-section p {
            color: #333;
            line-height: 1.6;
            margin-bottom: 10px;
        }
        
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
        }
        
        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            width: 90%;
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .modal-header h2 {
            font-size: 20px;
            color: #FA0030;
        }
        
        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }
        
        .close-btn:hover {
            color: #FA0030;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #999;
        }
        
        .loading::after {
            content: '...';
            animation: dots 1.5s steps(4, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        .leaderboard-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .leaderboard-table th,
        .leaderboard-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .leaderboard-table th {
            background: #FA0030;
            color: white;
            font-weight: 600;
            font-size: 14px;
        }
        
        .leaderboard-table tr:hover {
            background: #FED3DB;
        }
        
        .rank-1 { font-weight: 600; color: #FFD700; }
        .rank-2 { font-weight: 600; color: #C0C0C0; }
        .rank-3 { font-weight: 600; color: #CD7F32; }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ† í”„ë¡¬í”„íŠ¸ ê²½ì§„ëŒ€íšŒ ìë™ í‰ê°€ í”Œë«í¼ v3.0</h1>
            <p>ì‹¤ë¬´ììš© ì™„ì „í•œ ê´€ë¦¬ ì‹œìŠ¤í…œ - ëŒ€íšŒ/ê³¼ì œ/ì°¸ê°€ì ì„¤ì •, ì œì¶œë¬¼ ë“±ë¡, ìë™ ì±„ì , ìƒì„¸ ê²°ê³¼ ë¶„ì„</p>
        </header>
        
        <div class="tabs">
            <div class="tab active" onclick="switchTab('tasks')">ğŸ“ ê³¼ì œ ê´€ë¦¬</div>
            <div class="tab" onclick="switchTab('practitioners')">ğŸ‘¥ ì°¸ê°€ì ê´€ë¦¬</div>
            <div class="tab" onclick="switchTab('submissions')">ğŸ“¤ ì œì¶œë¬¼ ê´€ë¦¬</div>
            <div class="tab" onclick="switchTab('grading')">âš¡ ì±„ì  ì‹¤í–‰</div>
            <div class="tab" onclick="switchTab('dashboard')">ğŸ“Š ì±„ì  ê²°ê³¼ ëŒ€ì‹œë³´ë“œ</div>
        </div>
        
        <!-- ê³¼ì œ ê´€ë¦¬ íƒ­ -->
        <div id="tasks" class="tab-content active">
            <div class="section-title">ê³¼ì œ ê´€ë¦¬</div>
            <button class="btn btn-primary" onclick="showTaskModal()">+ ìƒˆ ê³¼ì œ ìƒì„±</button>
            
            <div id="tasks-list" class="list-container">
                <div class="loading">ê³¼ì œ ëª©ë¡ ë¡œë”© ì¤‘</div>
            </div>
        </div>
        
        <!-- ì°¸ê°€ì ê´€ë¦¬ íƒ­ -->
        <div id="practitioners" class="tab-content">
            <div class="section-title">ì°¸ê°€ì ê´€ë¦¬</div>
            <button class="btn btn-primary" onclick="showPractitionerModal()">+ ìƒˆ ì°¸ê°€ì ë“±ë¡</button>
            
            <div id="practitioners-list" class="list-container">
                <div class="loading">ì°¸ê°€ì ëª©ë¡ ë¡œë”© ì¤‘</div>
            </div>
        </div>
        
        <!-- ì œì¶œë¬¼ ê´€ë¦¬ íƒ­ -->
        <div id="submissions" class="tab-content">
            <div class="section-title">ì œì¶œë¬¼ ê´€ë¦¬</div>
            <button class="btn btn-primary" onclick="showSubmissionModal()">+ ìƒˆ ì œì¶œë¬¼ ë“±ë¡</button>
            
            <div style="margin: 20px 0;">
                <label>ê³¼ì œ í•„í„°: </label>
                <select id="submission-filter-task" onchange="loadSubmissions()">
                    <option value="">ì „ì²´</option>
                </select>
            </div>
            
            <div id="submissions-list" class="list-container">
                <div class="loading">ì œì¶œë¬¼ ëª©ë¡ ë¡œë”© ì¤‘</div>
            </div>
        </div>
        
        <!-- ì±„ì  ì‹¤í–‰ íƒ­ -->
        <div id="grading" class="tab-content">
            <div class="section-title">ì±„ì  ì‹¤í–‰</div>
            
            <div style="background: #FED3DB; padding: 20px; border-radius: 8px; margin-bottom: 20px;">
                <h3 style="color: #850028; margin-bottom: 10px;">âš ï¸ ì£¼ì˜ì‚¬í•­</h3>
                <ul style="color: #333; line-height: 1.8;">
                    <li>ì±„ì ì€ OpenAI APIë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤í–‰ë©ë‹ˆë‹¤ (ë¹„ìš© ë°œìƒ)</li>
                    <li>1ê°œ ì œì¶œë¬¼ë‹¹ ì•½ 30ì´ˆ~1ë¶„ ì†Œìš”</li>
                    <li>ì±„ì  ì¤‘ì—ëŠ” ë‹¤ë¥¸ ì‘ì—…ì„ ì§„í–‰í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</li>
                    <li>OPENAI_API_KEY í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì–´ ìˆì–´ì•¼ í•©ë‹ˆë‹¤</li>
                </ul>
            </div>
            
            <div class="form-group">
                <label>ê³¼ì œ ì„ íƒ:</label>
                <select id="grading-task-select">
                    <option value="">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                </select>
            </div>
            
            <div class="form-actions">
                <button class="btn btn-primary" onclick="gradeAllSubmissions()">ì„ íƒí•œ ê³¼ì œì˜ ëª¨ë“  ì œì¶œë¬¼ ì±„ì </button>
            </div>
            
            <div id="grading-status" style="margin-top: 20px;"></div>
        </div>
        
        <!-- ì±„ì  ê²°ê³¼ ëŒ€ì‹œë³´ë“œ íƒ­ -->
        <div id="dashboard" class="tab-content">
            <div class="section-title">ì±„ì  ê²°ê³¼ ëŒ€ì‹œë³´ë“œ</div>
            
            <div class="form-group">
                <label>ê³¼ì œ ì„ íƒ:</label>
                <select id="dashboard-task-select" onchange="loadDashboard()">
                    <option value="">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                </select>
            </div>
            
            <div id="dashboard-content">
                <p style="text-align: center; color: #999; padding: 40px;">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</p>
            </div>
        </div>
    </div>
    
    <!-- ëª¨ë‹¬: ê³¼ì œ ìƒì„±/ìˆ˜ì • -->
    <div id="task-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="task-modal-title">ìƒˆ ê³¼ì œ ìƒì„±</h2>
                <button class="close-btn" onclick="closeModal('task-modal')">&times;</button>
            </div>
            
            <form id="task-form" onsubmit="saveTask(event)">
                <input type="hidden" id="task-id">
                
                <div class="form-group">
                    <label>ê³¼ì œ ì œëª© *</label>
                    <input type="text" id="task-title" required>
                </div>
                
                <div class="form-group">
                    <label>ì„¤ëª…</label>
                    <textarea id="task-description"></textarea>
                </div>
                
                <div class="form-group">
                    <label>ì…ë ¥ ë°ì´í„° *</label>
                    <textarea id="task-input-data" required placeholder="ì°¸ê°€ìì—ê²Œ ì œê³µí•  ì…ë ¥ ë°ì´í„°"></textarea>
                </div>
                
                <div class="form-group">
                    <label>ê¸°ëŒ€ ì¶œë ¥ (ì •ë‹µ) *</label>
                    <div style="margin-bottom: 10px;">
                        <input type="file" id="task-golden-file" accept=".pdf,.txt,.xlsx,.xls,.csv" style="display: none;" onchange="handleFileUpload(event)">
                        <button type="button" class="btn btn-secondary" onclick="document.getElementById('task-golden-file').click()" style="margin-right: 10px;">
                            ğŸ“„ íŒŒì¼ ì—…ë¡œë“œ (PDF/TXT/Excel)
                        </button>
                        <span id="file-upload-status" style="font-size: 12px; color: #666;"></span>
                    </div>
                    <textarea id="task-golden-output" required placeholder="í”„ë¡¬í”„íŠ¸ ì‹¤í–‰ ì‹œ ë‚˜ì™€ì•¼ í•˜ëŠ” ê¸°ëŒ€ ê²°ê³¼ (ë˜ëŠ” ìœ„ íŒŒì¼ ì—…ë¡œë“œ ë²„íŠ¼ ì‚¬ìš©)"></textarea>
                </div>
                
                <div class="form-group">
                    <label>í‰ê°€ ë…¸íŠ¸</label>
                    <textarea id="task-evaluation-notes" placeholder="ì±„ì  ì‹œ ì°¸ê³ í•  ì¶”ê°€ ì •ë³´"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">ì €ì¥</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('task-modal')">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ëª¨ë‹¬: ì°¸ê°€ì ìƒì„±/ìˆ˜ì • -->
    <div id="practitioner-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="practitioner-modal-title">ìƒˆ ì°¸ê°€ì ë“±ë¡</h2>
                <button class="close-btn" onclick="closeModal('practitioner-modal')">&times;</button>
            </div>
            
            <form id="practitioner-form" onsubmit="savePractitioner(event)">
                <input type="hidden" id="practitioner-id">
                
                <div class="form-group">
                    <label>ì´ë¦„ *</label>
                    <input type="text" id="practitioner-name" required>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">ì €ì¥</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('practitioner-modal')">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ëª¨ë‹¬: ì œì¶œë¬¼ ìƒì„±/ìˆ˜ì • -->
    <div id="submission-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="submission-modal-title">ìƒˆ ì œì¶œë¬¼ ë“±ë¡</h2>
                <button class="close-btn" onclick="closeModal('submission-modal')">&times;</button>
            </div>
            
            <form id="submission-form" onsubmit="saveSubmission(event)">
                <input type="hidden" id="submission-id">
                
                <div class="form-group">
                    <label>ê³¼ì œ ì„ íƒ *</label>
                    <select id="submission-task-id" required>
                        <option value="">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>ì°¸ê°€ì ì„ íƒ *</label>
                    <select id="submission-practitioner-id" required>
                        <option value="">ì°¸ê°€ìë¥¼ ì„ íƒí•˜ì„¸ìš”</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>í”„ë¡¬í”„íŠ¸ *</label>
                    <textarea id="submission-prompt" required placeholder="ì°¸ê°€ìê°€ ì‘ì„±í•œ í”„ë¡¬í”„íŠ¸" style="min-height: 200px;"></textarea>
                </div>
                
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">ì €ì¥</button>
                    <button type="button" class="btn btn-secondary" onclick="closeModal('submission-modal')">ì·¨ì†Œ</button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- ëª¨ë‹¬: ì œì¶œë¬¼ ìƒì„¸ ë³´ê¸° -->
    <div id="submission-detail-modal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <div class="modal-header">
                <h2>ì œì¶œë¬¼ ìƒì„¸ ì •ë³´</h2>
                <button class="close-btn" onclick="closeModal('submission-detail-modal')">&times;</button>
            </div>
            
            <div id="submission-detail-content">
                <div class="loading">ë¡œë”© ì¤‘</div>
            </div>
        </div>
    </div>
    
    <script>
        // API ë² ì´ìŠ¤ URL
        const API_BASE = '';
        
        // í˜„ì¬ í™œì„± íƒ­
        let currentTab = 'tasks';
        
        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            // íƒ­ ë²„íŠ¼ í™œì„±í™”
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');
            
            // íƒ­ ì»¨í…ì¸  í™œì„±í™”
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            document.getElementById(tabName).classList.add('active');
            
            currentTab = tabName;
            
            // ë°ì´í„° ë¡œë“œ
            if (tabName === 'tasks') loadTasks();
            else if (tabName === 'practitioners') loadPractitioners();
            else if (tabName === 'submissions') loadSubmissions();
            else if (tabName === 'grading') loadGradingTab();
            else if (tabName === 'dashboard') loadDashboardTab();
        }
        
        // ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
        function openModal(modalId) {
            document.getElementById(modalId).classList.add('active');
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // ====================================================================
        // ê³¼ì œ ê´€ë¦¬
        // ====================================================================
        
        async function loadTasks() {
            try {
                const response = await fetch(`${API_BASE}/tasks`);
                const tasks = await response.json();
                
                const container = document.getElementById('tasks-list');
                
                if (tasks.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">ë“±ë¡ëœ ê³¼ì œê°€ ì—†ìŠµë‹ˆë‹¤</p>';
                    return;
                }
                
                container.innerHTML = tasks.map(task => `
                    <div class="list-item">
                        <div class="list-item-header">
                            <div class="list-item-title">${task.title}</div>
                            <div class="list-item-actions">
                                <button class="btn btn-secondary" onclick="editTask(${task.id})">ìˆ˜ì •</button>
                                <button class="btn btn-danger" onclick="deleteTask(${task.id})">ì‚­ì œ</button>
                            </div>
                        </div>
                        <div class="list-item-body">
                            ${task.description || 'ì„¤ëª… ì—†ìŒ'}
                            <br><small style="color: #999;">ìƒì„±ì¼: ${new Date(task.created_at).toLocaleString('ko-KR')}</small>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('ê³¼ì œ ë¡œë”© ì‹¤íŒ¨:', error);
                document.getElementById('tasks-list').innerHTML = '<p style="color: #ff4444;">ë¡œë”© ì‹¤íŒ¨</p>';
            }
        }
        
        function showTaskModal(taskId = null) {
            document.getElementById('task-form').reset();
            document.getElementById('task-id').value = '';
            document.getElementById('task-modal-title').textContent = 'ìƒˆ ê³¼ì œ ìƒì„±';
            
            if (taskId) {
                loadTaskForEdit(taskId);
            }
            
            openModal('task-modal');
        }
        
        async function loadTaskForEdit(taskId) {
            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}`);
                const task = await response.json();
                
                document.getElementById('task-id').value = task.id;
                document.getElementById('task-title').value = task.title;
                document.getElementById('task-description').value = task.description || '';
                document.getElementById('task-input-data').value = task.input_data || '';
                document.getElementById('task-golden-output').value = task.golden_output || '';
                document.getElementById('task-evaluation-notes').value = task.evaluation_notes || '';
                document.getElementById('task-modal-title').textContent = 'ê³¼ì œ ìˆ˜ì •';
            } catch (error) {
                alert('ê³¼ì œ ì •ë³´ ë¡œë”© ì‹¤íŒ¨');
            }
        }
        
        // íŒŒì¼ ì—…ë¡œë“œ ì²˜ë¦¬
        async function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const statusEl = document.getElementById('file-upload-status');
            statusEl.textContent = 'ì—…ë¡œë“œ ì¤‘...';
            statusEl.style.color = '#FA0030';
            
            try {
                const formData = new FormData();
                formData.append('file', file);
                
                const response = await fetch(`${API_BASE}/upload/parse`, {
                    method: 'POST',
                    body: formData
                });
                
                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.detail || 'íŒŒì¼ ì—…ë¡œë“œ ì‹¤íŒ¨');
                }
                
                const result = await response.json();
                document.getElementById('task-golden-output').value = result.text || result.content;
                
                statusEl.textContent = `âœ… ${file.name} ì—…ë¡œë“œ ì„±ê³µ`;
                statusEl.style.color = '#28a745';
                
                setTimeout(() => {
                    statusEl.textContent = '';
                }, 3000);
            } catch (error) {
                statusEl.textContent = `âŒ ì˜¤ë¥˜: ${error.message}`;
                statusEl.style.color = '#dc3545';
                console.error('File upload error:', error);
            }
        }
        
        async function saveTask(event) {
            event.preventDefault();
            
            const taskId = document.getElementById('task-id').value;
            const data = {
                title: document.getElementById('task-title').value,
                description: document.getElementById('task-description').value,
                input_data: document.getElementById('task-input-data').value,
                golden_output: document.getElementById('task-golden-output').value,
                evaluation_notes: document.getElementById('task-evaluation-notes').value
            };
            
            try {
                let response;
                if (taskId) {
                    response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                        method: 'PUT',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(data)
                    });
                } else {
                    response = await fetch(`${API_BASE}/tasks`, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(data)
                    });
                }
                
                if (response.ok) {
                    alert(taskId ? 'ê³¼ì œê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤' : 'ê³¼ì œê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤');
                    closeModal('task-modal');
                    loadTasks();
                } else {
                    alert('ì €ì¥ ì‹¤íŒ¨');
                }
            } catch (error) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        function editTask(taskId) {
            showTaskModal(taskId);
        }
        
        async function deleteTask(taskId) {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì—°ê²°ëœ ì œì¶œë¬¼ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.')) return;
            
            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    alert('ê³¼ì œê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
                    loadTasks();
                } else {
                    alert('ì‚­ì œ ì‹¤íŒ¨');
                }
            } catch (error) {
                alert('ì‚­ì œ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        // ====================================================================
        // ì°¸ê°€ì ê´€ë¦¬ (ê³¼ì œì™€ ìœ ì‚¬í•œ íŒ¨í„´)
        // ====================================================================
        
        async function loadPractitioners() {
            try {
                const response = await fetch(`${API_BASE}/practitioners`);
                const practitioners = await response.json();
                
                const container = document.getElementById('practitioners-list');
                
                if (practitioners.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">ë“±ë¡ëœ ì°¸ê°€ìê°€ ì—†ìŠµë‹ˆë‹¤</p>';
                    return;
                }
                
                container.innerHTML = practitioners.map(p => `
                    <div class="list-item">
                        <div class="list-item-header">
                            <div class="list-item-title">${p.name}</div>
                            <div class="list-item-actions">
                                <button class="btn btn-secondary" onclick="editPractitioner(${p.id})">ìˆ˜ì •</button>
                                <button class="btn btn-danger" onclick="deletePractitioner(${p.id})">ì‚­ì œ</button>
                            </div>
                        </div>
                        <div class="list-item-body">
                            <small style="color: #999;">ë“±ë¡ì¼: ${new Date(p.created_at).toLocaleString('ko-KR')}</small>
                        </div>
                    </div>
                `).join('');
            } catch (error) {
                console.error('ì°¸ê°€ì ë¡œë”© ì‹¤íŒ¨:', error);
            }
        }
        
        function showPractitionerModal(practitionerId = null) {
            document.getElementById('practitioner-form').reset();
            document.getElementById('practitioner-id').value = '';
            document.getElementById('practitioner-modal-title').textContent = 'ìƒˆ ì°¸ê°€ì ë“±ë¡';
            
            if (practitionerId) {
                loadPractitionerForEdit(practitionerId);
            }
            
            openModal('practitioner-modal');
        }
        
        async function loadPractitionerForEdit(practitionerId) {
            try {
                const response = await fetch(`${API_BASE}/practitioners/${practitionerId}`);
                const p = await response.json();
                
                document.getElementById('practitioner-id').value = p.id;
                document.getElementById('practitioner-name').value = p.name;
                document.getElementById('practitioner-modal-title').textContent = 'ì°¸ê°€ì ìˆ˜ì •';
            } catch (error) {
                alert('ì°¸ê°€ì ì •ë³´ ë¡œë”© ì‹¤íŒ¨');
            }
        }
        
        async function savePractitioner(event) {
            event.preventDefault();
            
            const practitionerId = document.getElementById('practitioner-id').value;
            const data = {
                name: document.getElementById('practitioner-name').value
            };
            
            try {
                let response;
                if (practitionerId) {
                    response = await fetch(`${API_BASE}/practitioners/${practitionerId}`, {
                        method: 'PUT',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(data)
                    });
                } else {
                    response = await fetch(`${API_BASE}/practitioners`, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(data)
                    });
                }
                
                if (response.ok) {
                    alert(practitionerId ? 'ì°¸ê°€ì ì •ë³´ê°€ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤' : 'ì°¸ê°€ìê°€ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤');
                    closeModal('practitioner-modal');
                    loadPractitioners();
                } else {
                    const error = await response.json();
                    alert('ì €ì¥ ì‹¤íŒ¨: ' + (error.detail || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            } catch (error) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        function editPractitioner(practitionerId) {
            showPractitionerModal(practitionerId);
        }
        
        async function deletePractitioner(practitionerId) {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì—°ê²°ëœ ì œì¶œë¬¼ë„ í•¨ê»˜ ì‚­ì œë©ë‹ˆë‹¤.')) return;
            
            try {
                const response = await fetch(`${API_BASE}/practitioners/${practitionerId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    alert('ì°¸ê°€ìê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
                    loadPractitioners();
                } else {
                    alert('ì‚­ì œ ì‹¤íŒ¨');
                }
            } catch (error) {
                alert('ì‚­ì œ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        // ====================================================================
        // ì œì¶œë¬¼ ê´€ë¦¬
        // ====================================================================
        
        async function loadSubmissions() {
            try {
                const taskFilter = document.getElementById('submission-filter-task').value;
                const url = taskFilter ? `${API_BASE}/submissions?task_id=${taskFilter}` : `${API_BASE}/submissions`;
                
                const response = await fetch(url);
                const submissions = await response.json();
                
                const container = document.getElementById('submissions-list');
                
                if (submissions.length === 0) {
                    container.innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">ë“±ë¡ëœ ì œì¶œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</p>';
                    return;
                }
                
                container.innerHTML = submissions.map(s => {
                    const statusBadge = `<span class="badge badge-${s.status}">${getStatusText(s.status)}</span>`;
                    const score = s.grading_result ? ` | ì ìˆ˜: ${s.grading_result.total_score}/100` : '';
                    
                    return `
                        <div class="list-item">
                            <div class="list-item-header">
                                <div class="list-item-title">${s.task_title} - ${s.practitioner_name}</div>
                                <div class="list-item-actions">
                                    ${statusBadge}
                                    <button class="btn btn-secondary" onclick="viewSubmissionDetail(${s.id})">ìƒì„¸</button>
                                    <button class="btn btn-secondary" onclick="editSubmission(${s.id})">ìˆ˜ì •</button>
                                    <button class="btn btn-danger" onclick="deleteSubmission(${s.id})">ì‚­ì œ</button>
                                </div>
                            </div>
                            <div class="list-item-body">
                                í”„ë¡¬í”„íŠ¸ (${s.prompt_text.length}ì)${score}
                                <br><small style="color: #999;">ì œì¶œì¼: ${new Date(s.created_at).toLocaleString('ko-KR')}</small>
                            </div>
                        </div>
                    `;
                }).join('');
            } catch (error) {
                console.error('ì œì¶œë¬¼ ë¡œë”© ì‹¤íŒ¨:', error);
            }
        }
        
        function getStatusText(status) {
            const map = {
                'submitted': 'ì œì¶œë¨',
                'grading': 'ì±„ì  ì¤‘',
                'completed': 'ì™„ë£Œ',
                'failed': 'ì‹¤íŒ¨'
            };
            return map[status] || status;
        }
        
        async function showSubmissionModal(submissionId = null) {
            // ê³¼ì œì™€ ì°¸ê°€ì ëª©ë¡ ë¡œë“œ
            await loadTasksForSelect();
            await loadPractitionersForSelect();
            
            document.getElementById('submission-form').reset();
            document.getElementById('submission-id').value = '';
            document.getElementById('submission-modal-title').textContent = 'ìƒˆ ì œì¶œë¬¼ ë“±ë¡';
            
            if (submissionId) {
                loadSubmissionForEdit(submissionId);
            }
            
            openModal('submission-modal');
        }
        
        async function loadTasksForSelect() {
            const response = await fetch(`${API_BASE}/tasks`);
            const tasks = await response.json();
            
            const selects = [
                document.getElementById('submission-task-id'),
                document.getElementById('submission-filter-task'),
                document.getElementById('grading-task-select'),
                document.getElementById('dashboard-task-select')
            ];
            
            selects.forEach(select => {
                if (select) {
                    const currentValue = select.value;
                    const options = tasks.map(t => `<option value="${t.id}">${t.title}</option>`).join('');
                    
                    if (select.id === 'submission-task-id') {
                        select.innerHTML = '<option value="">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>' + options;
                    } else if (select.id === 'submission-filter-task') {
                        select.innerHTML = '<option value="">ì „ì²´</option>' + options;
                    } else {
                        select.innerHTML = '<option value="">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</option>' + options;
                    }
                    
                    if (currentValue) select.value = currentValue;
                }
            });
        }
        
        async function loadPractitionersForSelect() {
            const response = await fetch(`${API_BASE}/practitioners`);
            const practitioners = await response.json();
            
            const select = document.getElementById('submission-practitioner-id');
            const options = practitioners.map(p => `<option value="${p.id}">${p.name} (${p.email})</option>`).join('');
            select.innerHTML = '<option value="">ì°¸ê°€ìë¥¼ ì„ íƒí•˜ì„¸ìš”</option>' + options;
        }
        
        async function loadSubmissionForEdit(submissionId) {
            try {
                const response = await fetch(`${API_BASE}/submissions/${submissionId}`);
                const s = await response.json();
                
                document.getElementById('submission-id').value = s.id;
                document.getElementById('submission-task-id').value = s.task_id;
                document.getElementById('submission-practitioner-id').value = s.practitioner_id;
                document.getElementById('submission-prompt').value = s.prompt_text;
                document.getElementById('submission-modal-title').textContent = 'ì œì¶œë¬¼ ìˆ˜ì •';
            } catch (error) {
                alert('ì œì¶œë¬¼ ì •ë³´ ë¡œë”© ì‹¤íŒ¨');
            }
        }
        
        async function saveSubmission(event) {
            event.preventDefault();
            
            const submissionId = document.getElementById('submission-id').value;
            const data = {
                task_id: parseInt(document.getElementById('submission-task-id').value),
                practitioner_id: parseInt(document.getElementById('submission-practitioner-id').value),
                prompt_text: document.getElementById('submission-prompt').value
            };
            
            try {
                let response;
                if (submissionId) {
                    response = await fetch(`${API_BASE}/submissions/${submissionId}`, {
                        method: 'PUT',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({prompt_text: data.prompt_text})
                    });
                } else {
                    response = await fetch(`${API_BASE}/submissions`, {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify(data)
                    });
                }
                
                if (response.ok) {
                    alert(submissionId ? 'ì œì¶œë¬¼ì´ ìˆ˜ì •ë˜ì—ˆìŠµë‹ˆë‹¤' : 'ì œì¶œë¬¼ì´ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤');
                    closeModal('submission-modal');
                    loadSubmissions();
                } else {
                    const error = await response.json();
                    alert('ì €ì¥ ì‹¤íŒ¨: ' + (error.detail || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'));
                }
            } catch (error) {
                alert('ì €ì¥ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        function editSubmission(submissionId) {
            showSubmissionModal(submissionId);
        }
        
        async function deleteSubmission(submissionId) {
            if (!confirm('ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            try {
                const response = await fetch(`${API_BASE}/submissions/${submissionId}`, {
                    method: 'DELETE'
                });
                
                if (response.ok) {
                    alert('ì œì¶œë¬¼ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤');
                    loadSubmissions();
                } else {
                    alert('ì‚­ì œ ì‹¤íŒ¨');
                }
            } catch (error) {
                alert('ì‚­ì œ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        async function viewSubmissionDetail(submissionId) {
            openModal('submission-detail-modal');
            document.getElementById('submission-detail-content').innerHTML = '<div class="loading">ë¡œë”© ì¤‘</div>';
            
            try {
                const response = await fetch(`${API_BASE}/submissions/${submissionId}`);
                const s = await response.json();
                
                let html = `
                    <h3 style="color: #FA0030; margin-bottom: 20px;">${s.task_title}</h3>
                    
                    <div style="margin-bottom: 20px;">
                        <strong>ì°¸ê°€ì:</strong> ${s.practitioner_name}<br>
                        <strong>ì œì¶œì¼:</strong> ${new Date(s.created_at).toLocaleString('ko-KR')}<br>
                        <strong>ìƒíƒœ:</strong> <span class="badge badge-${s.status}">${getStatusText(s.status)}</span>
                    </div>
                    
                    <h4>ì œì¶œí•œ í”„ë¡¬í”„íŠ¸:</h4>
                    <pre style="background: #f9f9f9; padding: 15px; border-radius: 8px; overflow-x: auto;">${s.prompt_text}</pre>
                `;
                
                if (s.status === 'completed' && s.grading_result) {
                    const gr = s.grading_result;
                    
                    html += `
                        <div class="score-breakdown">
                            <div class="score-item accuracy">
                                <h4>ì •í™•ì„±</h4>
                                <div class="score">${gr.accuracy_score}/50</div>
                            </div>
                            <div class="score-item clarity">
                                <h4>ëª…í™•ì„±</h4>
                                <div class="score">${gr.clarity_score}/30</div>
                            </div>
                            <div class="score-item consistency">
                                <h4>ì¼ê´€ì„±</h4>
                                <div class="score">${gr.consistency_score}/20</div>
                            </div>
                        </div>
                        
                        <div style="text-align: center; margin: 20px 0;">
                            <h3 style="color: #FA0030;">ì´ì : ${gr.total_score}/100</h3>
                        </div>
                    `;
                    
                    if (s.execution_output_1 || s.execution_output_2 || s.execution_output_3) {
                        html += `<div class="execution-outputs">`;
                        html += `<h4>í”„ë¡¬í”„íŠ¸ ì‹¤í–‰ ê²°ê³¼ (3íšŒ):</h4>`;
                        
                        if (s.execution_output_1) {
                            html += `
                                <div class="output-item">
                                    <h4>1ì°¨ ì‹¤í–‰ ê²°ê³¼:</h4>
                                    <pre>${s.execution_output_1.substring(0, 500)}${s.execution_output_1.length > 500 ? '...' : ''}</pre>
                                </div>
                            `;
                        }
                        
                        if (s.execution_output_2) {
                            html += `
                                <div class="output-item">
                                    <h4>2ì°¨ ì‹¤í–‰ ê²°ê³¼:</h4>
                                    <pre>${s.execution_output_2.substring(0, 500)}${s.execution_output_2.length > 500 ? '...' : ''}</pre>
                                </div>
                            `;
                        }
                        
                        if (s.execution_output_3) {
                            html += `
                                <div class="output-item">
                                    <h4>3ì°¨ ì‹¤í–‰ ê²°ê³¼:</h4>
                                    <pre>${s.execution_output_3.substring(0, 500)}${s.execution_output_3.length > 500 ? '...' : ''}</pre>
                                </div>
                            `;
                        }
                        
                        html += `</div>`;
                    }
                    
                    html += `
                        <div class="feedback-section">
                            <h4>ğŸ“Š ì •í™•ì„± í”¼ë“œë°±</h4>
                            <p>${gr.accuracy_feedback || 'N/A'}</p>
                            
                            <h4>ğŸ“ ëª…í™•ì„± í”¼ë“œë°±</h4>
                            <p>${gr.clarity_feedback || 'N/A'}</p>
                            
                            <h4>ğŸ”„ ì¼ê´€ì„± í”¼ë“œë°±</h4>
                            <p>${gr.consistency_feedback || 'N/A'}</p>
                            
                            <h4>ğŸ’¡ ì¢…í•© í”¼ë“œë°±</h4>
                            <p>${gr.overall_feedback || 'N/A'}</p>
                        </div>
                    `;
                } else if (s.status === 'failed') {
                    html += `
                        <div style="background: #ffebee; padding: 20px; border-radius: 8px; color: #c62828;">
                            <h4>âŒ ì±„ì  ì‹¤íŒ¨</h4>
                            <p>${s.grading_result?.error || 'ì•Œ ìˆ˜ ì—†ëŠ” ì˜¤ë¥˜'}</p>
                        </div>
                    `;
                } else {
                    html += `
                        <div style="background: #e3f2fd; padding: 20px; border-radius: 8px;">
                            <p>ì•„ì§ ì±„ì ë˜ì§€ ì•Šì€ ì œì¶œë¬¼ì…ë‹ˆë‹¤.</p>
                            <button class="btn btn-primary" onclick="gradeOneSubmission(${s.id})">ì§€ê¸ˆ ì±„ì í•˜ê¸°</button>
                        </div>
                    `;
                }
                
                document.getElementById('submission-detail-content').innerHTML = html;
            } catch (error) {
                document.getElementById('submission-detail-content').innerHTML = '<p style="color: #ff4444;">ë¡œë”© ì‹¤íŒ¨</p>';
            }
        }
        
        // ====================================================================
        // ì±„ì  ì‹¤í–‰
        // ====================================================================
        
        async function loadGradingTab() {
            await loadTasksForSelect();
        }
        
        async function gradeOneSubmission(submissionId) {
            try {
                const response = await fetch(`${API_BASE}/submissions/${submissionId}/grade`, {
                    method: 'POST'
                });
                
                if (response.ok) {
                    alert('ì±„ì ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤. ì™„ë£Œê¹Œì§€ ì•½ 30ì´ˆ~1ë¶„ ì†Œìš”ë©ë‹ˆë‹¤.');
                    closeModal('submission-detail-modal');
                } else {
                    alert('ì±„ì  ì‹œì‘ ì‹¤íŒ¨');
                }
            } catch (error) {
                alert('ì±„ì  ì‹œì‘ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        async function gradeAllSubmissions() {
            const taskId = document.getElementById('grading-task-select').value;
            
            if (!taskId) {
                alert('ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”');
                return;
            }
            
            if (!confirm('ì„ íƒí•œ ê³¼ì œì˜ ëª¨ë“  ì œì¶œë¬¼ì„ ì±„ì í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n(OpenAI API ë¹„ìš©ì´ ë°œìƒí•©ë‹ˆë‹¤)')) {
                return;
            }
            
            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}/grade_all`, {
                    method: 'POST'
                });
                
                const result = await response.json();
                
                if (response.ok) {
                    document.getElementById('grading-status').innerHTML = `
                        <div style="background: #e8f5e9; padding: 20px; border-radius: 8px; color: #2e7d32;">
                            <h4>âœ… ì±„ì ì´ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤</h4>
                            <p>${result.message}</p>
                            <p>ì™„ë£Œê¹Œì§€ ì•½ ${result.submission_ids.length * 0.5}~${result.submission_ids.length}ë¶„ ì†Œìš” ì˜ˆìƒ</p>
                            <p>ì±„ì  í˜„í™©ì€ 'ì±„ì  ê²°ê³¼ ëŒ€ì‹œë³´ë“œ' íƒ­ì—ì„œ í™•ì¸í•˜ì„¸ìš”</p>
                        </div>
                    `;
                } else {
                    alert('ì±„ì  ì‹œì‘ ì‹¤íŒ¨: ' + result.message);
                }
            } catch (error) {
                alert('ì±„ì  ì‹œì‘ ì‹¤íŒ¨: ' + error.message);
            }
        }
        
        // ====================================================================
        // ëŒ€ì‹œë³´ë“œ
        // ====================================================================
        
        async function loadDashboardTab() {
            await loadTasksForSelect();
        }
        
        async function loadDashboard() {
            const taskId = document.getElementById('dashboard-task-select').value;
            
            if (!taskId) {
                document.getElementById('dashboard-content').innerHTML = '<p style="text-align: center; color: #999; padding: 40px;">ê³¼ì œë¥¼ ì„ íƒí•˜ì„¸ìš”</p>';
                return;
            }
            
            document.getElementById('dashboard-content').innerHTML = '<div class="loading">ëŒ€ì‹œë³´ë“œ ë¡œë”© ì¤‘</div>';
            
            try {
                const response = await fetch(`${API_BASE}/tasks/${taskId}/dashboard`);
                const dashboard = await response.json();
                
                const stats = dashboard.statistics;
                const total = stats.total || 0;
                const completed = stats.completed || 0;
                const progress = total > 0 ? (completed / total * 100).toFixed(1) : 0;
                
                let html = `
                    <div class="dashboard-stats">
                        <div class="stat-card">
                            <h3>ì´ ì œì¶œë¬¼</h3>
                            <div class="value">${stats.total}</div>
                        </div>
                        <div class="stat-card">
                            <h3>ì±„ì  ì™„ë£Œ</h3>
                            <div class="value">${stats.completed}</div>
                        </div>
                        <div class="stat-card">
                            <h3>ì±„ì  ì¤‘</h3>
                            <div class="value">${stats.grading}</div>
                        </div>
                        <div class="stat-card">
                            <h3>ëŒ€ê¸° ì¤‘</h3>
                            <div class="value">${stats.pending}</div>
                        </div>
                        <div class="stat-card">
                            <h3>ì§„í–‰ë¥ </h3>
                            <div class="value">${progress}%</div>
                        </div>
                    </div>
                `;
                
                if (dashboard.leaderboard && dashboard.leaderboard.length > 0) {
                    html += `
                        <h3 style="margin: 30px 0 15px 0; color: #FA0030;">ğŸ† ë¦¬ë”ë³´ë“œ</h3>
                        <table class="leaderboard-table">
                            <thead>
                                <tr>
                                    <th>ìˆœìœ„</th>
                                    <th>ì°¸ê°€ì</th>
                                    <th>ì´ì </th>
                                    <th>ì •í™•ì„±</th>
                                    <th>ëª…í™•ì„±</th>
                                    <th>ì¼ê´€ì„±</th>
                                    <th>ì±„ì ì¼</th>
                                    <th>ìƒì„¸</th>
                                </tr>
                            </thead>
                            <tbody>
                    `;
                    
                    dashboard.leaderboard.forEach((item, index) => {
                        const rank = index + 1;
                        const rankClass = rank <= 3 ? `rank-${rank}` : '';
                        
                        html += `
                            <tr>
                                <td class="${rankClass}">${rank}</td>
                                <td>${item.practitioner_name}</td>
                                <td><strong>${item.total_score}</strong></td>
                                <td>${item.accuracy_score}</td>
                                <td>${item.clarity_score}</td>
                                <td>${item.consistency_score}</td>
                                <td>${new Date(item.graded_at).toLocaleString('ko-KR')}</td>
                                <td><button class="btn btn-secondary" onclick="viewSubmissionDetail(${item.submission_id})">ìƒì„¸</button></td>
                            </tr>
                        `;
                    });
                    
                    html += `
                            </tbody>
                        </table>
                    `;
                } else {
                    html += `<p style="text-align: center; color: #999; padding: 40px;">ì•„ì§ ì±„ì  ì™„ë£Œëœ ì œì¶œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</p>`;
                }
                
                document.getElementById('dashboard-content').innerHTML = html;
            } catch (error) {
                console.error('ëŒ€ì‹œë³´ë“œ ë¡œë”© ì‹¤íŒ¨:', error);
                document.getElementById('dashboard-content').innerHTML = '<p style="color: #ff4444;">ë¡œë”© ì‹¤íŒ¨</p>';
            }
        }
        
        // ====================================================================
        // ì´ˆê¸°í™”
        // ====================================================================
        
        window.onload = () => {
            loadTasks();
        };
    </script>
</body>
</html>
